<!doctype html>
<html lang="hi">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>7D All-in-One — Extended</title>
<style>
body{margin:0;font-family:sans-serif;background:#071427;color:#fff;font-size:30px;background-image:url('7d_background.jpg');background-size:cover;background-position:center;}
header{display:flex;gap:10px;padding:10px;background:rgba(0,0,0,0.5);}
button{font-size:30px;padding:10px;border:none;border-radius:10px;cursor:pointer;background:rgba(255,255,255,0.1);color:#fff;}
main{padding:20px;}
.card{background:rgba(0,0,0,0.4);padding:20px;border-radius:14px;margin-bottom:20px;}
input, select, textarea{padding:10px;border-radius:8px;border:none;background:rgba(255,255,255,0.1);color:#fff;font-size:30px;width:100%;}
#tttBoard{display:grid;grid-template-columns:repeat(3,1fr);gap:10px;}
.ttt-cell{background:rgba(255,255,255,0.1);padding:20px;text-align:center;cursor:pointer;}
.file-item{display:flex;justify-content:space-between;align-items:center;background:rgba(255,255,255,0.1);padding:10px;margin-top:5px;border-radius:8px;}
#calcInput{width:80%;}
</style>
</head>
<body>

<header>
<button onclick="openPanel('home')">Home</button>
<button onclick="openPanel('weather')">Weather</button>
<button onclick="openPanel('clock')">Clock</button>
<button onclick="openPanel('calendar')">Calendar</button>
<button onclick="openPanel('game')">Game</button>
<button onclick="openPanel('locker')">Locker</button>
<button onclick="openPanel('calculator')">Calculator</button>
<button onclick="openPanel('ai')">AI Assistant</button>
</header>

<main>
<section id="home" class="card">Welcome to 7D All-in-One</section>

<section id="weather" class="card" style="display:none">
<h2>Weather</h2>
<input id="weatherCity" placeholder="City e.g. Mumbai">
<button onclick="searchWeather()">Search</button>
<div id="weatherResult"></div>
</section>

<section id="clock" class="card" style="display:none">
<h2>Clock</h2>
<div id="digitalClock">00:00:00</div>
</section>

<section id="calendar" class="card" style="display:none">
<h2>Calendar</h2>
<div id="calMonthYear"></div>
<div id="calGrid" style="display:grid;grid-template-columns:repeat(7,1fr);gap:5px;"></div>
<button onclick="prevMonth()">Prev</button>
<button onclick="nextMonth()">Next</button>
<button onclick="goToday()">Today</button>
</section>

<section id="game" class="card" style="display:none">
<h2>Tic-Tac-Toe</h2>
<label><input type="checkbox" id="aiToggle"> Play vs AI</label>
<div id="tttBoard"></div>
<div id="tttMsg"></div>
<button onclick="resetGame()">Restart</button>
</section>

<section id="locker" class="card" style="display:none">
<h2>Locker</h2>
<div id="lockerArea">
<input type="file" id="lockerFile">
<button onclick="saveLockerFile()">Save File</button>
<div id="lockerFiles"></div>
</div>
</section>

<section id="calculator" class="card" style="display:none">
<h2>Calculator</h2>
<input id="calcInput" placeholder="Enter expression" value="1234">
<button onclick="calculate()">=</button>
<div id="calcResult"></div>
</section>

<section id="ai" class="card" style="display:none">
<h2>AI Assistant</h2>
<input id="aiQuestion" placeholder="Ask something...">
<button onclick="askAI()">Search</button>
<div id="aiAnswer" style="margin-top:10px;"></div>
<button onclick="resetAIKey()">Reset API Key</button>
</section>

</main>

<script>
function openPanel(id){
  const sections=['home','weather','clock','calendar','game','locker','calculator','ai'];
  sections.forEach(s=>document.getElementById(s).style.display=s===id?'block':'none');
}

// Weather Demo
function searchWeather(){
  const city=document.getElementById('weatherCity').value.trim();
  if(!city)return;
  const cond=['Sunny','Cloudy','Rainy','Foggy'];const temp=20+Math.floor(Math.random()*10);
  document.getElementById('weatherResult').innerHTML=city+' - '+cond[Math.floor(Math.random()*cond.length)]+', '+temp+'°C';
}

// Clock
function startClock(){
  setInterval(()=>{
    const d=new Date();
    document.getElementById('digitalClock').innerText=d.toLocaleTimeString();
  },1000);
}
startClock();

// Calendar
let calDate=new Date();
function renderCalendar(){
  const grid=document.getElementById('calGrid');grid.innerHTML='';
  const year=calDate.getFullYear(),month=calDate.getMonth();
  document.getElementById('calMonthYear').innerText=calDate.toLocaleString('default',{month:'long'})+' '+year;
  const firstDay=new Date(year,month,1).getDay();
  const daysInMonth=new Date(year,month+1,0).getDate();
  ['Sun','Mon','Tue','Wed','Thu','Fri','Sat'].forEach(h=>{const el=document.createElement('div');el.innerText=h;grid.appendChild(el);});
  for(let i=0;i<firstDay;i++){const el=document.createElement('div');grid.appendChild(el);}
  for(let d=1;d<=daysInMonth;d++){const el=document.createElement('div');el.innerText=d;if(d===new Date().getDate()&&month===new Date().getMonth())el.style.background='yellow';grid.appendChild(el);}
}
function prevMonth(){calDate=new Date(calDate.getFullYear(),calDate.getMonth()-1,1);renderCalendar();}
function nextMonth(){calDate=new Date(calDate.getFullYear(),calDate.getMonth()+1,1);renderCalendar();}
function goToday(){calDate=new Date();renderCalendar();}
renderCalendar();

// Tic-Tac-Toe
let board=Array(9).fill(''),turn='X',scores={X:0,O:0,D:0};
function renderBoard(){const root=document.getElementById('tttBoard');root.innerHTML='';board.forEach((v,i)=>{const cell=document.createElement('div');cell.className='ttt-cell';cell.innerText=v;cell.onclick=()=>playMove(i);root.appendChild(cell);});}
function playMove(i){if(board[i]||checkWin(board))return;board[i]=turn;const res=checkWin(board);if(res){handleResult(res);return;}turn=turn==='X'?'O':'X';renderBoard();if(document.getElementById('aiToggle').checked&&turn==='O'){setTimeout(()=>{aiMove();const r=checkWin(board);if(r)handleResult(r);else turn='X';renderBoard();},250);}}
function aiMove(){const empties=board.map((v,i)=>v?null:i).filter(x=>x!==null);for(const idx of empties){const copy=board.slice();copy[idx]='O';if(checkWin(copy)==='O'){board[idx]='O';return;}}for(const idx of empties){const copy=board.slice();copy[idx]='X';if(checkWin(copy)==='X'){board[idx]='O';return;}}if(board[4]===''){board[4]='O';return;}const corners=[0,2,6,8].filter(i=>board[i]==='');if(corners.length>0){board[corners[Math.floor(Math.random()*corners.length)]]='O';return;}board[empties[Math.floor(Math.random()*empties.length)]]='O';}
function checkWin(b){const wins=[[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];for(const w of wins){const [a,b1,c]=w;if(b[a]&&b[a]===b[b1]&&b[a]===b[c])return b[a];}if(b.every(x=>x))return 'Draw';return null;}
function handleResult(res){if(res==='Draw'){document.getElementById('tttMsg').innerText='Draw!';scores.D++;}else{document.getElementById('tttMsg').innerText=res+' wins!';scores[res]++;}setTimeout(()=>{board=Array(9).fill('');turn='X';document.getElementById('tttMsg').innerText='';renderBoard();},1200);}
function resetGame(){board=Array(9).fill('');turn='X';scores={X:0,O:0,D:0};document.getElementById('tttMsg').innerText='';renderBoard();}
renderBoard();

// Calculator
function calculate(){const expr=document.getElementById('calcInput').value;try{document.getElementById('calcResult').innerText=eval(expr);}catch(e){document.getElementById('calcResult').innerText='Error';}}

// Locker
function saveLockerFile(){const f=document.getElementById('lockerFile').files[0];if(!f){alert('Choose file');return;}const reader=new FileReader();reader.onload=()=>{let arr=JSON.parse(localStorage.getItem('locker_files')||'[]');arr.push({name:f.name,data:reader.result});localStorage.setItem('locker_files',JSON.stringify(arr));renderLockerFiles();alert('Saved');};reader.readAsDataURL(f);}
function renderLockerFiles(){const list=document.getElementById('lockerFiles');list.innerHTML='';let arr=JSON.parse(localStorage.getItem('locker_files')||'[]');arr.forEach(f=>{const el=document.createElement('div');el.className='file-item';el.innerHTML=`${f.name} <a href="${f.data}" download="${f.name}">Download</a>`;list.appendChild(el);});}

// AI Assistant
async function askAI(){const q=document.getElementById('aiQuestion').value.trim();if(!q)return;let key=localStorage.getItem('openai_key');if(!key){key=prompt('Enter OpenAI API key');if(!key)return;localStorage.setItem('openai_key',key);}document.getElementById('aiAnswer').innerText='Loading...';try{const resp=await fetch('https://api.openai.com/v1/chat/completions',{method:'POST',headers:{'Content-Type':'application/json','Authorization':'Bearer '+key},body:JSON.stringify({model:'gpt-3.5-turbo',messages:[{role:'user',content:q}],temperature:0.7,max_tokens:150})});const data=await resp.json();document.getElementById('aiAnswer').innerText=data.choices?.[0]?.message?.content||'No answer';}catch(e){document.getElementById('aiAnswer').innerText='Error: '+e.message;}}
function resetAIKey(){localStorage.removeItem('openai_key');alert('AI key cleared');}
</script>

</body>
</html>